# $Id$
PortSystem 1.0

name			vimproc
version			v4.00
revision		6
categories		editors
maintainers		nomaintainer
description		Interactive command execution in Vim.
long_description \
	Interactive command execution in Vim.
homepage		http://github.com/Shougo/vimproc/
platforms		darwin

#set gittag		${version}
set gittag		3ec9a4978c8c404302299c671efec0aa2598cc3c
distname		${name}-${gittag}
use_zip			yes
checksums		${distname}.zip sha1 763546fc54460ab9c0b8c3fe80187a7b1fe7ce59
master_sites	"http://github.com/Shougo/vimproc/zipball/${gittag}?"
use_configure	no
build.cmd		make -f make_mac.mak

post-extract {
	system "mv ${workpath}/Shougo-vimproc-* ${workpath}/${distname}"
}

post-patch {
	reinplace -E "s/^(CFLAGS.*)/\\1 -mmacosx-version-min=10.6/" \
		${worksrcpath}/make_mac.mak
}

destroot {
	set dstdir ${destroot}${prefix}/share/vimproc

	set autoloaddir ${dstdir}/autoload
	set autoloadsrc ${worksrcpath}/autoload
	xinstall -d -m 0755 ${autoloaddir}
	xinstall -d -m 0755 ${autoloaddir}/vimproc
	xinstall -m 0755 ${autoloadsrc}/proc.so ${autoloaddir}
	xinstall -m 0644 ${autoloadsrc}/vimproc.vim ${autoloaddir}
	xinstall -m 0644 ${autoloadsrc}/vimproc/parser.vim ${autoloaddir}/vimproc
	xinstall -m 0644 ${autoloadsrc}/vimproc/util.vim ${autoloaddir}/vimproc

	set docdir ${dstdir}/doc
	xinstall -d -m 0755 ${docdir}
	xinstall -m 0644 ${worksrcpath}/doc/vimproc.jax ${docdir}
	xinstall -m 0644 ${worksrcpath}/doc/vimproc.txt ${docdir}

	set plugindir ${dstdir}/plugin
	xinstall -d -m 0755 ${plugindir}
	xinstall -m 0644 ${worksrcpath}/plugin/vimproc.vim ${plugindir}
}

default_variants +universal
variant universal {}
