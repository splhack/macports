# $Id$
PortSystem 1.0

name			vimproc
version			v4.00
revision		3
categories		editors
maintainers		nomaintainer
description		Interactive command execution in Vim.
long_description \
	Interactive command execution in Vim.
homepage		http://github.com/Shougo/vimproc/
platforms		darwin

#set gittag		${version}
set gittag		f843a274f969a85fbbc180d4a8acabb5cd5d13c0
distname		${name}-${gittag}
use_zip			yes
checksums		${distname}.zip sha1 3b2f22d979e3ecc7bb569d9c620c19d0df9a6785
master_sites	"http://github.com/Shougo/vimproc/zipball/${gittag}?"
use_configure	no
build.cmd		make -f make_mac.mak

post-extract {
	system "mv ${workpath}/Shougo-vimproc-* ${workpath}/${distname}"
}

post-patch {
	reinplace -E "s/^(CFLAGS.*)/\\1 -arch ppc -mmacosx-version-min=10.5/" \
		${worksrcpath}/make_mac.mak
}

destroot {
	set dstdir ${destroot}${prefix}/share/vimproc

	set autoloaddir ${dstdir}/autoload
	set autoloadsrc ${worksrcpath}/autoload
	xinstall -d -m 0755 ${autoloaddir}
	xinstall -d -m 0755 ${autoloaddir}/vimproc
	xinstall -m 0755 ${autoloadsrc}/proc.so ${autoloaddir}
	xinstall -m 0644 ${autoloadsrc}/vimproc.vim ${autoloaddir}
	xinstall -m 0644 ${autoloadsrc}/vimproc/parser.vim ${autoloaddir}/vimproc
	xinstall -m 0644 ${autoloadsrc}/vimproc/util.vim ${autoloaddir}/vimproc

	set docdir ${dstdir}/doc
	xinstall -d -m 0755 ${docdir}
	xinstall -m 0644 ${worksrcpath}/doc/vimproc.jax ${docdir}
	xinstall -m 0644 ${worksrcpath}/doc/vimproc.txt ${docdir}

	set plugindir ${dstdir}/plugin
	xinstall -d -m 0755 ${plugindir}
	xinstall -m 0644 ${worksrcpath}/plugin/vimproc.vim ${plugindir}
}

default_variants +universal
variant universal {}
